# Key Objects

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-stylize.stylize_folder-start--->
## stylize.stylize_folder

<!---Documatic-section-stylize_folder-start--->
<!---Documatic-block-stylize.stylize_folder-start--->
<details>
	<summary><code>stylize.stylize_folder</code> code snippet</summary>

```python
def stylize_folder(style_path, folder_containing_the_content_folder, save_folder, batch_size=1):
    device = 'cuda' if torch.cuda.is_available() else 'cpu'
    transform = transforms.Compose([transforms.ToTensor(), transforms.Lambda(lambda x: x.mul(255))])
    image_dataset = utils.ImageFolderWithPaths(folder_containing_the_content_folder, transform=transform)
    image_loader = torch.utils.data.DataLoader(image_dataset, batch_size=batch_size)
    net = transformer.TransformerNetwork()
    net.load_state_dict(torch.load(style_path))
    net = net.to(device)
    with torch.no_grad():
        for (content_batch, _, path) in image_loader:
            torch.cuda.empty_cache()
            generated_tensor = net(content_batch.to(device)).detach()
            for i in range(len(path)):
                generated_image = utils.ttoi(generated_tensor[i])
                if PRESERVE_COLOR:
                    generated_image = utils.transfer_color(content_image, generated_image)
                image_name = os.path.basename(path[i])
                utils.saveimg(generated_image, save_folder + image_name)
```
</details>
<!---Documatic-block-stylize.stylize_folder-end--->
<!---Documatic-section-stylize_folder-end--->

# #
<!---Documatic-section-stylize.stylize_folder-end--->

<!---Documatic-section-stylize.stylize_folder_single-start--->
## stylize.stylize_folder_single

<!---Documatic-section-stylize_folder_single-start--->
<!---Documatic-block-stylize.stylize_folder_single-start--->
<details>
	<summary><code>stylize.stylize_folder_single</code> code snippet</summary>

```python
def stylize_folder_single(style_path, content_folder, save_folder):
    device = 'cuda' if torch.cuda.is_available() else 'cpu'
    net = transformer.TransformerNetwork()
    net.load_state_dict(torch.load(style_path))
    net = net.to(device)
    images = [img for img in os.listdir(content_folder) if img.endswith('.jpg')]
    with torch.no_grad():
        for image_name in images:
            torch.cuda.empty_cache()
            content_image = utils.load_image(content_folder + image_name)
            content_tensor = utils.itot(content_image).to(device)
            generated_tensor = net(content_tensor)
            generated_image = utils.ttoi(generated_tensor.detach())
            if PRESERVE_COLOR:
                generated_image = utils.transfer_color(content_image, generated_image)
            utils.saveimg(generated_image, save_folder + image_name)
```
</details>
<!---Documatic-block-stylize.stylize_folder_single-end--->
<!---Documatic-section-stylize_folder_single-end--->

# #
<!---Documatic-section-stylize.stylize_folder_single-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)